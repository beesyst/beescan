# 🛡️ SecWebScan

## 📌 Описание проекта

**SecWebScan** — модульная платформа для автоматизированного анализа сетевой и веб-безопасности. Поддерживает подключение различных инструментов в виде плагинов, сбор и хранение результатов, генерацию отчётов, а также гибкую централизированную настройку. Архитектура проекта легко расширяется под любые задачи аудита и мониторинга.

## ⚙️ Основные возможности

✅ **Поддержка плагинов** — 2 инструмента.  
✅ **Plug-and-Play архитектура** — каждый инструмент вынесен в отдельный модуль-парсер.  
✅ **Вывод в PostgreSQL** и рендер отчетов из БД.  
✅ **Тул-профили** — выбирай уровень обработки сканера в каждом инструменте.  
✅ **Генерация отчетов**: TERMINAL, HTML, PDF.  
✅ **Изоляция через Docker** — отдельные контейнеры для ядра и БД.  
✅ **Логирование** — отдельные логи для хоста и контейнера.
✅ **Мультиязычность** - бот поддерживает **переключение языка** через `config.json` и добавление новых языков в `lang.json`.

## 🌍 Где можно использовать

🛡️ **Пентесты и тесты на проникновение**  
📶 **Аудит инфраструктуры и веб-сервисов**  
🏛️ **Безопасность государственных и корпоративных сетей**  
⚙️ **DevSecOps и CI/CD**

## 🛠️ Технологический стек

🐍 **Python** — основной язык разработки  
🐘 **PostgreSQL** — база данных  
🐳 **Docker** — контейнеризация среды  
📄 **Jinja2** — шаблоны отчетов  
📊 **Rich** — таблицы в терминале  
📂 **WeasyPrint** — генерация PDF

### 🔌 Подключенные инструменты:
- nmap — мощный сетевой сканер с поддержкой сотен NSE-скриптов, позволяет определять открытые порты, версии сервисов, ОС, а также выполнять уязвимостные проверки.
- nikto — сканер веб-уязвимостей.

## 🖧 Архитектура

📌 **Компоненты системы:**

1️⃣ **Плагины** — отдельные инструменты (например, `nmap`, `nikto`), которые выполняют активное сканирование и сохраняют результаты в `results/`. 
2️⃣ **Коллектор (collector.py)** — обрабатывает результаты с помощью соответствующего парсера из `plugins/*.py` и сохраняет структурированные данные в PostgreSQL.
3️⃣ **База данных (PostgreSQL)** — централизованное хранилище результатов сканирования.  
4️⃣ **Генератор отчетов (report_generator.py)** — извлекает данные из БД и формирует отчеты в формате TERMINAL, HTML и PDF (через Jinja2 и WeasyPrint).  
5️⃣ **Docker-среда** — полностью изолированное окружение (база, core, сканеры).  
6️⃣ **Конфигурационный модуль** — гибкая настройка через `config/config.json` (таргет, плагины, уровень сканирования, тема отчета и пр.).  
7️⃣ **start.py** — центральный скрипт запуска, который автоматически запускает все окружение, сканирование, сбор и генерацию отчетов.

### **📂 Структура проекта**

``` 
secwebscan/
├── config/                  # Конфигурация
│   ├── config.json          # Основной конфигурационный файл
│   └── start.py             # Главный скрипт запуска проекта (на Python)
├── core/                    # Ядро системы
│   ├── collector.py         # Парсит результаты и сохраняет в БД
│   ├── logger_container.py  # Логгер для записи из контейнера
│   ├── logger_host.py       # Логгер для записи на хосте
│   ├── plugin_runner.py     # Запускает активные плагины
│   └── report_generator.py  # Генерирует отчеты из БД
├── db/                      # База данных (PostgreSQL)
│   ├── compose.yaml         # Docker Compose конфигурация
│   ├── Dockerfile           # Dockerfile для создания образа PostgreSQL (опционально)
│   ├── init.sql             # Скрипт инициализации таблиц
│   └── populate_db.py       # Скрипт ручной вставки тестовых данных
├── docker/                  # Docker-инфраструктура
│   ├── Dockerfile.base      # Dockerfile базового контейнера secwebscan-base
│   └── install_plugins.py   # Скрипт установки CLI-инструментов в контейнер
├── logs/                    # Логи запуска и работы
│   ├── container.log        # Лог из контейнера
│   └── host.log             # Лог из хоста
├── plugins/                 # Плагины-сканеры
│   ├── nmap.py              # Парсер Nmap
│   └── nikto.py             # Парсер Nikto
├── reports/                 # Сгенерированные HTML и PDF отчеты
├── results/                 # Сырые XML/JSON-результаты сканеров
├── templates/               # Шаблоны Jinja2 для отчетов
│   ├── css/                 # Папка css-файлами
│   └── report.html.j2       # HTML-шаблон для генерации отчета
├── README.md                # Документация проекта
├── requirements.txt         # Зависимости Python
└── start.sh                 # Bash-скрипт для авто-запуска всех компонентов
```

## ⚙️ Pipeplan: Как это работает?

🔹 **Запуск системы**:
1. Система запускается через `start.sh`.
2. Проверяется наличие Docker и Docker-сети `secwebscan_network`.
3. Запускается контейнер PostgreSQL (если он не активен).
4. Собирается образ `secwebscan-base` (если не создан).
5. Поднимается контейнер `secwebscan_base` с подключенными томами.
6. Запускается `plugin_runner.py` для выполнения сканеров.
7. Запускается `collector.py` для сбора и записи результатов в PostgreSQL.
8. Генерируются отчеты в форматах: `terminal`, `html`, `pdf`.

🔹 **Работа плагинов**:
1. `plugin_runner.py` читает `config.json`, определяет активные модули.
2. Запускает каждый сканер (например, `nmap`) с соответствующими аргументами и сохраняет результаты сканирования в папку `results/`.
3. Для каждого активного модуля вызывается функция `parse()` из `plugins/*.py`.

🔹 **Сбор данных (collector.py)**:
1. Коллектор подключается к БД.
2. Очищает старые записи, если включено `purge_on_start`.
3. Подгружает нужный парсер из `plugins/*.py`.
4. Парсит XML или JSON-файл.
5. Записывает структурированные данные в таблицу `results` или `{plugin}_results`.

🔹 **Генерация отчетов**:
1. `report_generator.py` получает данные из БД.
2. Использует шаблоны Jinja2 для генерации:
   - терминального отчета (`rich`-таблицы),
   - HTML отчета (`report.html.j2`),
   - PDF отчета (через `WeasyPrint`).
3. HTML-отчет автоматически открывается в браузере (если `"open_report": true` в `config.json`).
4. Поддерживаются темы оформления: светлая (`"report_theme": "light"`) и темная (`"report_theme": "dark"`).

🔹 **Пример для Nmap**:
1. В `config.json` выбран модуль `nmap`, установлен уровень `middle`.
2. Запускается `-T4 -sS -sV -Pn --open`.
3. Парсер `plugins/nmap.py` обрабатывает XML и передает данные в коллектор.
4. Данные сохраняются в таблицу `nmap_results`.
5. `report_generator.py` визуализирует их в итоговых отчетах.

> ⚙️ Все директории внутри контейнера монтируются из проекта для полной синхронизации и совместимости.

## 🔧 Установка и запуск

### 🔄 Запуск проекта

```bash
bash start.sh
```

В процессе установки нужно будет выбрать язык установки.

### 🔄 Настройка конфигурации

Все параметры задаются в файле `config.json`:

Вот улучшенная и понятная версия, где юзеру **чётко видно**, что делает `true`, а что — `false`:

---

### 🔧 Настройка конфигурации (`config/config.json`)

В секции `"scan_config"` можно управлять поведением системы:

```
| Параметр             | Значение по умолчанию  | Что делает `true`                                 | Что делает `false`                             |
|----------------------|------------------------|---------------------------------------------------|------------------------------------------------|
| `target`             | `"1.1.1.1"`            | Сканирует указанный IP или домен                  | —                                              |
| `report_formats`     | `["html"]`             | Генерирует указанные форматы: terminal/html/pdf   | —                                              |
| `open_report`        | `true`                 | Авто-открытие HTML и PDF-отчёта в браузере        | Отчёт не открывается автоматически             |
| `clear_logs`         | `true`                 | Очищает `logs/host.log` и `container.log` при запуске | Логи сохраняются и накапливаются              |
| `clear_reports`      | `true`                 | Удаляет старые отчёты из папки `reports/`         | Старые отчёты сохраняются                      |
| `purge_on_start`     | `true`                 | Полностью очищает таблицу `results` в БД перед сканированием | Старые результаты остаются в базе        |
| `report_theme`       | `"dark"`               | Используется тёмная тема в HTML-отчёте            | `"light"` — светлая тема отчёта                |
```
---

## **🔮 Дорожная карта**

✅ **Отчеты из БД**  
✅ **Асинхронный запуск плагинов**  
✅ **Тестирование на Ubuntu 24.04 (Wayland)**  
✅ **Гибкая конфигурация через `config.json`**  
🔜 **Поддержка новых сканеров**
🔜 **PDF-отчеты**
🔜 **CI для автоматического запуска**
🔜 **Подключение к Prometheus / Grafana**

## 💰 Донат

- **USDT (TRC20)**/**USDC (TRC20)**: `TUQj3sguQjmKFJEMotyb3kERVgnfvhzG7o`
- **SOL (Solana)**: `6VA9oJbkszteTZJbH6mmLioKTSq4r4E3N1bsoPaxQgr4`
- **XRP (XRP)**: `rDkEZehHFqSjiGdBHsseR64fCcRXuJbgfr`

---

**🛡 Licensed for non-commercial use only. See [LICENSE](LICENSE) for details.**